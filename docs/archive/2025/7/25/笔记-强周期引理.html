<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content=""><title>笔记: 强周期引理 | kyEEcccccc 的枢纽</title>
  <meta name="keywords" content="">
  <meta name="description" content=""><link rel="stylesheet" href="/assets/main.css?v=0.3.3" />
<script src="/assets/main.js?v=0.3.3" defer></script>
        <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    TeX: {
        equationNumbers: {
            autoNumber: "AMS"
        }
    },
    tex2jax: {
        inlineMath: [ ['$','$'] ],
        displayMath: [ ['$$','$$'] ],
        processEscapes: true,
    }
});
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  
  <style>
	.post__content {
	text-align: left;
	}
  </style>
</head>
<body class="body-page">
    <a href="/" class="logo"><h1>kyEEcccccc 的枢纽</h1>
</a><main class="post__wrapper"><nav class="top-nav">

<a href="/" class="nav-link ">主页</a>


<a href="/categories/" class="nav-link ">分类</a>


<a href="/about-me/" class="nav-link ">关于我</a>


</nav><article class="post">
    <header class="post__header">
      <h1 class="post__title page__title">笔记: 强周期引理</h1>
    </header>
    <div class="post__content content">
      <h2 id="符号约定">符号约定</h2>

<ul>
  <li>$[n] = \mathbb{Z}\cap [1,n] (n\in \mathbb{Z}^+)$.</li>
</ul>

<h2 id="border-与周期">Border 与周期</h2>

<p>一个字符串的一个 Border, 是指它的一个真前缀, 这个真前缀与它的同样长度的真后缀完全相同. 同时, 有时也指某个 Border 的长度.</p>

<p>一个长度为 $n$ 的字符串 $s$ 的周期, 是指一个整数 $k(1\le k &lt; n)$, 使得 $\forall i\in [n - k], \text{有 }s_i = s_{i+k}$. 同时, 有时也指长度为 $k$ 的前缀或后缀. 真周期是说这个周期的同时还整除 $n$.</p>

<p>不难发现, 一个周期的补是一个 Border, 一个 Border 的补是一个周期. 所以, 研究周期就是研究 Border, 研究 Border 就是研究周期.</p>

<h2 id="弱周期引理weak-periodicity-lemma">弱周期引理(Weak Periodicity Lemma)</h2>

<p>如果长度为 $n$ 的字符串 $s$ 有两个周期 $a, b(a &lt; b)$, 这两个周期会产生什么相互作用呢?</p>

<blockquote>
  <p>弱周期引理:</p>

  <p>对于 $s$ 的两个周期 $a, b$, 如果 $a + b \le n$, 那么 $\gcd(a, b)$ 也是 $s$ 的一个周期.</p>
</blockquote>

<p>这是因为, 如果 $a + b\le n$, 那么 $\forall i\in [n - b + a], \text{有 } i + b\le n \lor i - a\ge 1$, 所以要么 $s_i = s_{i + b} = s_{i + b - a}$, 要么 $s_i = s_{i - a} = s_{i - a + b}$, 所以 $b - a$ 也是 $s$ 的一个周期.</p>

<p>显然, 运用数学归纳法, 结合欧几里得算法的知识, 不难证明 $\gcd(a, b)$ 也是 $s$ 的一个周期.</p>

<h2 id="强周期引理strong-periodicity-lemma">(强)周期引理((Strong) Periodicity Lemma)</h2>

<p>强周期引理改进了上述定理中不等式的界.</p>

<blockquote>
  <p>(强)周期引理:</p>

  <p>对于 $s$ 的两个周期 $a, b$, 如果 $a + b - \gcd(a, b) \le n$, 那么 $\gcd(a, b)$ 也是 $s$ 的一个周期.</p>
</blockquote>

<p>强周期引理有许多证明方法. 这里给出最典范的一个.</p>

<p>考虑将 $\mathbb{Z}^+$ 按照 ${} \bmod a$ 的余数分类, 那么会有 $a$ 类. 结合周期为 $b$ 的限制, 也就是会进行 $n - b$ 次合并, 每次将 $i \bmod a$ 和 $(i + b) \bmod a$ 的等价类合并($1\le i\le n - b$). 如果 $n \to +\infty$, 显然, 最终只会剩下 $\gcd(a, b)$ 个等价类, 这是弱周期引理向我们指出的. 强周期引理就是要探究, $n$ 最少是多少时, 所有能合并的等价类一定都合并完了. 这个值记作 $n_0$</p>

<p>不难发现, 因为每次至多使等价类的个数减少 $1$, 所以, 至少需要 $a - \gcd(a, b)$ 次合并, 所以 $n - b \ge a - \gcd(a, b)$, 所以 $a + b - \gcd(a, b) \le n$. 也就是说, 强周期引理给出的不等式左式是 $n_0$ 的一个下界. 如果强周期引理成立, 那么它同时也是 $n_0$ 的一个上界.</p>

<p>将 $\mathbb{Z}\cap[0, a)$ 按照 ${} \bmod \gcd(a, b)$ 的值划分等价类. 对于每个等价类内部的点, 我们考虑在 $x$ 与 $(x + b) \bmod a$ 之间连边, 这样, 每个等价类形如一个环, 这个环的大小是 $\frac{a}{\gcd(a, b)}$. 现在, 对于所有 $i\in [n_0 - b] = [a + b - \gcd(a, b) - b] = [a - \gcd(a, b)]$, 我们将 $i \bmod a$ 和 $(i + b) \bmod a$ 对应的边合并. 显然, 在每个环上这等同于从一条边开始依次向后合并, 总的合并次数是 $\frac{a - \gcd(a, b)}{\gcd(a, b)} = \frac{a}{\gcd(a, b)} - 1$. 所以, 每个环都恰好被合并为了一个点. 所以只要 $n\ge n_0$, 就可以说明 $\gcd(a, b)$ 也是 $s$ 的一个周期.</p>


    </div>
  </article><aside class="post__contact"><h4><a href="">kyEEcccccc</a></h4>
  
<div class="icon__list"><a href="mailto:3044923282@qq.com" class="icon__link" target="_blank"><svg class="icon__stroke" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
  <polyline points="22,6 12,13 2,6"></polyline>
</svg>
</a><a href="https://github.com/KevinYao1224" class="icon__link" target="_blank"><svg viewBox="0 0 64 64" class="icon__fill">
  <path stroke-width="0" d="M32 0 C14 0 0 14 0 32 0 53 19 62 22 62 24 62 24 61 24 60 L24 55 C17 57 14 53 13 50 13 50 13 49 11 47 10 46 6 44 10 44 13 44 15 48 15 48 18 52 22 51 24 50 24 48 26 46 26 46 18 45 12 42 12 31 12 27 13 24 15 22 15 22 13 18 15 13 15 13 20 13 24 17 27 15 37 15 40 17 44 13 49 13 49 13 51 20 49 22 49 22 51 24 52 27 52 31 52 42 45 45 38 46 39 47 40 49 40 52 L40 60 C40 61 40 62 42 62 45 62 64 53 64 32 64 14 50 0 32 0 Z" />
</svg>
</a></div>
</aside>
</main><footer class="site-footer">
  © 2025<a href="/">kyEEcccccc 的枢纽</a>. Theme<a href="https://github.com/erlzhang/jekyll-theme-persephone" target="_blank">Persephone</a>
</footer>

  </body>
</html>
